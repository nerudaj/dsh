"use strict";var LOG_ERROR_LEVEL=1;function fa(t){return document.getElementById(t)}function fb(t){return document.getElementsByName(t)}function fc(t,e,n){var o="ERROR: "+t+"::"+e+": "+n;console.error(o),0<LOG_ERROR_LEVEL&&alert(o)}function fd(t,e){return Math.floor(Math.random()*e+t)}function fe(t,e){return void 0!==t?t:e}function ff(t,e,n,o){var i=fe(o,100),a=fa("HiddenResizer");a.style.fontSize=i+"px",a.innerHTML=t;for(var d=a.offsetWidth,r=a.offsetHeight;.8*e<d||.8*n<r;)i-=1,a.style.fontSize=i+"px",d=a.offsetWidth,r=a.offsetHeight;return i}function aElement(){this.dom=null,this.width=0,this.height=0}function View(){this.app=null}function App(){this.context={},this.canvas=new aElement,this.views={},this.currentView=""}function RenderDice(){var t=this.app.canvas,e=t.add(0,0,1,.1);e.pc("Kdo začne?",!0),e.pb("#AAAAAA");var n=t.add(0,.1,1,.8,"div","a");n.pb("lightgrey");var o=ff("#######",n.width,n.height,1e3);n.dom.style.fontSize=o+"px",n.pc("??");var i=t.add(0,.9,1,.1);i.pb("grey"),i.dom.style.border="1px solid black",fg(i,this.app)}function fg(t,e){var n=t.add(0,0,1/3,1,"button"),o=ff("Hoď kostkami",n.width,n.height);n.dom.pa("click",function(){fh(e)}),n.dom.style.fontSize=o+"px",n.pc("Hoď kostkami");var i=t.add(1/3,0,1/3,1,"button");i.dom.pa("click",function(){fi(e)}),i.dom.style.fontSize=o+"px",i.pc("Hoď mincí");var a=t.add(2/3,0,1/3,1,"button");a.dom.pa("click",function(){e.toggleView("score")}),a.dom.style.fontSize=o+"px",a.pc("Zpět")}function fh(t){var e=["⚀","⚁","⚂","⚃","⚄","⚅"],n=fd(1,6)-1,o=fd(1,6)-1,i=fd(1,6)-1;fa("a").innerHTML=e[n]+" "+e[o]+" "+e[i]}function fi(t){fa("a").innerHTML=["hlava","orel"][fd(1,2)-1]}Element.prototype.pa=function(t,e){this.addEventListener(t,e)},aElement.prototype.add=function(t,e,n,o,i,a){i=fe(i,"div"),a=fe(a,null);var d=new aElement,r=document.createElement(i);return null!=a&&r.setAttribute("id",a),this.dom.appendChild(r),d.dom=r,d.width=this.width*n,d.height=this.height*o,d.dom.style.position="absolute",d.dom.style.left=this.width*t+"px",d.dom.style.top=this.height*e+"px",d.dom.style.width=d.width+"px",d.dom.style.height=d.height+"px",d},aElement.prototype.pb=function(t){this.dom.style.background=t},aElement.prototype.pc=function(t,e,n){var o=null;(e=fe(e,!1))?(n=fe(n,100),o=ff(t,this.width,this.height,n)):"undefined"!==n&&(o=n);var i=document.createTextNode(t);null!=o&&(this.dom.style.fontSize=o+"px"),this.dom.appendChild(i)},View.prototype.render=function(){fc("View","render","This method is not implemented!")},View.prototype.bootstrap=function(t){this.app=t},App.prototype.addView=function(t,e){var n=this.views;return n.hasOwnProperty(e)?(fc("App","addView","View with name "+e+" already exists!"),!1):(n[e]=t,n[e].bootstrap(this),!0)},App.prototype.toggleView=function(t){this.views.hasOwnProperty(t)?(this.currentView=t,this.render()):fc("App","toggleView","View called "+t+" does not exist!")},App.prototype.render=function(){var t=this.canvas;t.dom.innerHTML="",t.width=window.innerWidth,t.height=window.innerHeight,t.dom.style.position="absolute",t.dom.style.width=t.width+"px",t.dom.style.height=t.height+"px",this.views[this.currentView].render()},App.prototype.bootstrap=function(t){this.canvas.dom=fa(t);var e=this;window.addEventListener("resize",function(){e.render()})};var va=null;function RenderScore(){var t=this.app.canvas;fj(t.add(0,0,1,.9),this.app);var e=t.add(0,.9,1,.1);e.dom.style.border="1px solid black",e.pb("grey"),fm(e,this.app)}function fj(t,e){for(var n=e.context.players.length,o=2==n?1:2,i=Math.ceil(n/o),a=1/o,d=1/i,r=0,c=0;c<i;c++)for(var f=0;f<o;f++){n%2==1&&r+1==n&&(a=1);var p=t.add(f*a,c*d,a,d);if(p.dom.style.border="1px solid black",p.pb(e.context.players[r].color),fk(r,p,e),n==++r)return}}function fk(t,e,n){null==va&&(va=ff("XX",.25*e.width,e.height)),e.add(.25,0,.5,1,"div","b"+t).dom.style.fontSize=va+"px";var o=e.add(0,0,.25,1,"button");o.pc("−",!1,va),o.dom.pa("click",function(){fl(n.context.players,t,-1)}),o.dom.className="score_btn";var i=e.add(.75,0,.25,1,"button");i.pc("+",!1,va),i.dom.pa("click",function(){fl(n.context.players,t,1)}),i.dom.className="score_btn",fl(n.context.players,t,n.context.players[t].score,!0)}function fl(t,e,n,o){o=fe(o,!1);t[e].score=(o?0:parseInt(t[e].score))+n,fa("b"+e).innerHTML=t[e].score}function fm(t,e){var n=t.add(0,0,1/3,1,"button","c"),o=ff("Nastavení",n.width,n.height);n.dom.style.fontSize=o+"px",n.pc("Kdo začne?"),n.dom.pa("click",function(){e.toggleView("dice")});var i=t.add(1/3,0,1/3,1,"button");i.dom.style.fontSize=o+"px",i.pc("Nezdržuj"),i.dom.pa("click",function(){e.toggleView("timer")});var a=t.add(2/3,0,1/3,1,"button","d");a.dom.style.fontSize=o+"px",a.pc("Nastavení"),a.dom.pa("click",function(){e.toggleView("settings")})}var vb=2,vc=6,Colors=["red","lightgreen","lightblue","yellow","pink","orange","grey","white"],vd="init_score_btn init_score_btn_left",ve="init_score_btn init_score_btn_right";function RenderSettings(){var t=this.app.canvas,e=t.add(0,0,1,.9);e.pb("lightgrey"),fn(e,this.app);var n=t.add(0,.9,1,.1);n.dom.style.border="1px solid black",n.pb("grey"),fs(n,this.app)}function fn(t,e){var n=1/11;t.dom.style.fontSize=ff("Počáteční skóre",t.width,t.height*n)+"px";var o=t.add(0,0,1,n);o.pc("Počet hráčů:",!1),o.pb("#AAAAAA"),fo(t.add(0,1*n,1,n),e);var i=t.add(0,2*n,1,n);i.pc("Počáteční skóre:",!1),i.pb("#AAAAAA"),fp(t.add(0,3*n,1,n),e);var a=t.add(0,4*n,1,n);a.pc("Barvy hráčů:",!1),a.pb("#AAAAAA"),fr(t.add(0,5*n,1,6*n),e)}function fo(t,e){for(var n=1/(vc-vb+1),o=vb;o<=vc;o++){var i=t.add((o-vb)*n,0,n,1),a="";o==e.context.numOfPlayers&&(a="checked"),i.dom.innerHTML='<input type="radio" name="e" value="'+o+'" '+a+">"+o+"</radio>"}}function fp(t,e){var n=t.add(0,0,.2,1,"button");n.dom.pa("click",function(){fq(-5,e)}),n.dom.className=vd,n.pb("darkred"),n.pc("-5",!0);var o=t.add(.2,0,.2,1,"button");o.dom.pa("click",function(){fq(-1,e)}),o.dom.className=ve,o.pb("red"),o.pc("-1",!0),t.add(.4,0,.2,1,"div","f").pc(e.context.initScore,!0);var i=t.add(3*.2,0,.2,1,"button");i.dom.pa("click",function(){fq(1,e)}),i.dom.className=vd,i.pb("lightgreen"),i.pc("1",!0);var a=t.add(.8,0,.2,1,"button");a.dom.pa("click",function(){fq(5,e)}),a.dom.className=ve,a.pb("green"),a.pc("5",!0)}function fq(t,e){var n=fa("f");e.context.initScore=parseInt(n.innerHTML)+t,n.innerHTML=e.context.initScore}function fr(t,e){for(var n=1/vc,o=1/Colors.length,i=0;i<vc;i++){var a=t.add(0,i*n,1,n);a.dom.style.border="1px solid black";for(var d=0;d<Colors.length;d++){var r=a.add(d*o,0,o,1);r.pb(Colors[d]);var c="";e.context.colorSetup[i]==d&&(c="checked"),r.dom.innerHTML='<input type="radio" name="g'+i+'" value="'+d+'" '+c+">"}}}function fs(t,e){var n=t.add(0,0,.5,1,"button");n.dom.pa("click",function(){ft(e),e.toggleView("score")}),n.pc("Použít",!0);var o=t.add(.5,0,.5,1,"button");o.dom.pa("click",function(){e.toggleView("score")}),o.pc("Zpět",!0)}function ft(t){for(var e=t.context,n=e.players,o=fb("e"),i=0;i<o.length;i++)if(o[i].checked){e.numOfPlayers=o[i].value;break}for(;e.numOfPlayers<n.length;)n.pop();for(;e.numOfPlayers>n.length;)n.push(new Player);for(var a=0;a<n.length;a++){var d=fb("g"+a);for(i=0;i<d.length;i++)if(d[i].checked){e.colorSetup[a]=i;break}n[a].color=Colors[e.colorSetup[a]],n[a].score=e.initScore}}function RenderTimer(){var t=this.app.canvas,e=t.add(0,0,1,.9);e.pb("lightgrey"),fu(e,this.app);var n=t.add(0,.9,1,.1);n.dom.style.border="1px solid black",n.pb("grey"),fv(n,this.app)}function fu(t,e){var n=e.context;n.countdown=n.initCountdown;var o=t.add(0,0,1,.1);o.pc("Odpočet",!0),o.pb("#AAAAAA"),t.add(0,.1,1,.4,"div","h").pc(fw(n.initCountdown),!0),fx(t.add(0,.5,1,.1),e);t.add(0,.6,1,.1);var i=t.add(0,.7,1,.1);i.pc("Nastavení",!0),i.pb("#AAAAAA"),fy(t.add(0,.8,1,.2),e)}function fv(t,e){var n=t.add(0,0,.5,1,"button");n.dom.pa("click",function(){fz(e,"stop")}),n.pc("Nastav",!0);var o=t.add(.5,0,.5,1,"button");o.dom.pa("click",function(){e.toggleView("score")}),o.pc("Zpět",!0)}function fw(t){var e=t%60;return Math.floor(t/60)+":"+e}function fx(n,o){for(var i=[["Spusť","play"],["Pauza","pause"],["Reset","stop"]],a=1/i.length,d=0;d<i.length;d++)!function(){var t=d,e=n.add(t*a,0,a,1,"button");e.dom.pa("click",function(){fz(o,i[t][1])}),e.pc(i[t][0],!0)}()}function fy(t,e){var n=t.add(0,0,.2,1,"button");n.dom.pa("click",function(){fza(e,-5)}),n.dom.className=vd,n.pb("darkred"),n.pc("-5",!0);var o=t.add(.2,0,.2,1,"button");o.dom.pa("click",function(){fza(e,-1)}),o.dom.className=ve,o.pb("red"),o.pc("-1",!0),t.add(.4,0,.2,1,"div","i").pc("XX:XX",!0);var i=t.add(.6,0,.2,1,"button");i.dom.pa("click",function(){fza(e,1)}),i.dom.className=vd,i.pb("lightgreen"),i.pc("+1",!0);var a=t.add(.8,0,.2,1,"button");a.dom.pa("click",function(){fza(e,5)}),a.dom.className=ve,a.pb("green"),a.pc("+5",!0),fza(e,0)}function fz(t,e){var n=t.context;"play"==e?n.cntIntHndl=setInterval(function(){var t=fa("h");n.countdown--,t.innerHTML=fw(n.countdown),0==n.countdown&&(clearInterval(n.cntIntHndl),t.innerHTML="KONEC!")},1e3):"pause"==e?clearInterval(n.cntIntHndl):"stop"==e?(clearInterval(n.cntIntHndl),n.countdown=n.initCountdown,fa("h").innerHTML=fw(n.countdown)):fc("Timer","fz","Invalid action name: "+e)}function fza(t,e){var n=t.context;n.initCountdown=parseInt(n.initCountdown)+parseInt(e),fa("i").innerHTML=fw(n.initCountdown)}